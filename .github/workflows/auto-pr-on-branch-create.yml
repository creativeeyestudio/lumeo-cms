name: Auto-create PR when branch is created

on:
  create:    # Se déclenche sur création de tag ou branche
    branches:
      - "*"   # on ne réagit qu'aux branches

jobs:
  create-pr:
    if: startsWith(github.ref, 'refs/heads/')  # ignore les tags
    runs-on: ubuntu-latest

    permissions:
      pull-requests: write
      contents: read

    steps:
      - name: Extraire le nom de la branche
        id: vars
        run: |
          BRANCH="${GITHUB_REF#refs/heads/}"
          echo "branch=$BRANCH" >> $GITHUB_OUTPUT

      - name: Créer la Pull Request
        uses: peter-evans/create-pull-request@v5
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          base: develop                     # Branche cible
          head: ${{ steps.vars.outputs.branch }}
          title: "Auto PR from new branch: ${{ steps.vars.outputs.branch }}"
          body: |
            Cette PR a été créée automatiquement lorsque la branche **${{ steps.vars.outputs.branch }}** a été créée.
          draft: false                      # mettre true si tu veux des PR en draft
